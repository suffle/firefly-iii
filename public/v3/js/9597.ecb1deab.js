"use strict";(self["webpackChunkfirefly_iii"]=self["webpackChunkfirefly_iii"]||[]).push([[9597],{9597:(e,s,r)=>{r.r(s),r.d(s,{default:()=>F});var l=r(9835),o=r(6970);const t={class:"row q-mx-md"},i={class:"col-12"},a={class:"row q-mx-md q-mt-md"},n={class:"col-12"},d=(0,l._)("div",{class:"text-h6"},"Info for new webhook",-1),u={class:"row"},m={class:"col-12 q-mb-xs"},b={class:"row"},c={class:"col-12 q-mb-xs"},p={class:"row"},h={class:"col-12 q-mb-xs"},g={class:"row"},v={class:"col-12 q-mb-xs"},_={class:"row"},E={class:"col-12 q-mb-xs"},S={class:"row q-mx-md"},f={class:"col-12"},w={class:"row"},R={class:"col-12 text-right"},I={class:"row"},k={class:"col-12 text-right"},q=(0,l._)("br",null,null,-1);function V(e,s,r,V,x,N){const T=(0,l.up)("q-btn"),W=(0,l.up)("q-banner"),C=(0,l.up)("q-card-section"),y=(0,l.up)("q-input"),O=(0,l.up)("q-select"),A=(0,l.up)("q-card"),U=(0,l.up)("q-checkbox"),G=(0,l.up)("q-page");return(0,l.wg)(),(0,l.j4)(G,null,{default:(0,l.w5)((()=>[(0,l._)("div",t,[(0,l._)("div",i,[""!==x.errorMessage?((0,l.wg)(),(0,l.j4)(W,{key:0,"inline-actions":"",rounded:"",class:"bg-orange text-white"},{action:(0,l.w5)((()=>[(0,l.Wm)(T,{flat:"",onClick:N.dismissBanner,label:"Dismiss"},null,8,["onClick"])])),default:(0,l.w5)((()=>[(0,l.Uk)((0,o.zw)(x.errorMessage)+" ",1)])),_:1})):(0,l.kq)("",!0)])]),(0,l._)("div",a,[(0,l._)("div",n,[(0,l.Wm)(A,{bordered:""},{default:(0,l.w5)((()=>[(0,l.Wm)(C,null,{default:(0,l.w5)((()=>[d])),_:1}),(0,l.Wm)(C,null,{default:(0,l.w5)((()=>[(0,l._)("div",u,[(0,l._)("div",m,[(0,l.Wm)(y,{"error-message":x.submissionErrors.title,error:x.hasSubmissionErrors.title,"bottom-slots":"",disable:N.disabledInput,type:"text",clearable:"",modelValue:x.title,"onUpdate:modelValue":s[0]||(s[0]=e=>x.title=e),label:e.$t("form.title"),outlined:""},null,8,["error-message","error","disable","modelValue","label"])])]),(0,l._)("div",b,[(0,l._)("div",c,[(0,l.Wm)(y,{"error-message":x.submissionErrors.url,error:x.hasSubmissionErrors.url,"bottom-slots":"",disable:N.disabledInput,type:"text",clearable:"",modelValue:x.url,"onUpdate:modelValue":s[1]||(s[1]=e=>x.url=e),label:e.$t("form.url"),outlined:""},null,8,["error-message","error","disable","modelValue","label"])])]),(0,l._)("div",p,[(0,l._)("div",h,[(0,l.Wm)(O,{"error-message":x.submissionErrors.response,error:x.hasSubmissionErrors.response,"bottom-slots":"",disable:N.disabledInput,outlined:"",modelValue:x.response,"onUpdate:modelValue":s[2]||(s[2]=e=>x.response=e),"emit-value":"",class:"q-pr-xs","map-options":"",options:x.responses,label:"Response"},null,8,["error-message","error","disable","modelValue","options"])])]),(0,l._)("div",g,[(0,l._)("div",v,[(0,l.Wm)(O,{"error-message":x.submissionErrors.delivery,error:x.hasSubmissionErrors.delivery,"bottom-slots":"",disable:N.disabledInput,outlined:"",modelValue:x.delivery,"onUpdate:modelValue":s[3]||(s[3]=e=>x.delivery=e),"emit-value":"",class:"q-pr-xs","map-options":"",options:x.deliveries,label:"Delivery"},null,8,["error-message","error","disable","modelValue","options"])])]),(0,l._)("div",_,[(0,l._)("div",E,[(0,l.Wm)(O,{"error-message":x.submissionErrors.trigger,error:x.hasSubmissionErrors.trigger,"bottom-slots":"",disable:N.disabledInput,outlined:"",modelValue:x.trigger,"onUpdate:modelValue":s[4]||(s[4]=e=>x.trigger=e),"emit-value":"",class:"q-pr-xs","map-options":"",options:x.triggers,label:"Triggers"},null,8,["error-message","error","disable","modelValue","options"])])])])),_:1})])),_:1})])]),(0,l._)("div",S,[(0,l._)("div",f,[(0,l.Wm)(A,{class:"q-mt-xs"},{default:(0,l.w5)((()=>[(0,l.Wm)(C,null,{default:(0,l.w5)((()=>[(0,l._)("div",w,[(0,l._)("div",R,[(0,l.Wm)(T,{disable:N.disabledInput,color:"primary",label:"Submit",onClick:N.submitWebhook},null,8,["disable","onClick"])])]),(0,l._)("div",I,[(0,l._)("div",k,[(0,l.Wm)(U,{disable:N.disabledInput,modelValue:x.doReturnHere,"onUpdate:modelValue":s[5]||(s[5]=e=>x.doReturnHere=e),"left-label":"",label:"Return here to create another one"},null,8,["disable","modelValue"]),q,(0,l.Wm)(U,{modelValue:x.doResetForm,"onUpdate:modelValue":s[6]||(s[6]=e=>x.doResetForm=e),"left-label":"",disable:!x.doReturnHere||N.disabledInput,label:"Reset form after submission"},null,8,["modelValue","disable"])])])])),_:1})])),_:1})])])])),_:1})}var x=r(1569);class N{post(e){let s="/api/v1/webhooks";return x.api.post(s,e)}}var T=r(1049);const W={name:"Create",data(){return{submissionErrors:{},hasSubmissionErrors:{},submitting:!1,doReturnHere:!1,doResetForm:!1,errorMessage:"",balance_input_mask:"#.##",triggers:[{value:"TRIGGER_STORE_TRANSACTION",label:"When transaction stored"},{value:"TRIGGER_UPDATE_TRANSACTION",label:"When transaction updated"},{value:"TRIGGER_DESTROY_TRANSACTION",label:"When transaction deleted"}],responses:[{value:"RESPONSE_TRANSACTIONS",label:"Send transaction"},{value:"RESPONSE_ACCOUNTS",label:"Send accounts"},{value:"RESPONSE_NONE",label:"Send nothing"}],deliveries:[{value:"DELIVERY_JSON",label:"JSON"}],title:"",url:"",response:"RESPONSE_TRANSACTIONS",delivery:"DELIVERY_JSON",trigger:"TRIGGER_STORE_TRANSACTION"}},watch:{},computed:{...(0,T.Se)("fireflyiii",["getCacheKey"]),disabledInput:function(){return this.submitting}},created(){this.resetForm()},methods:{resetForm:function(){this.title=""},resetErrors:function(){this.submissionErrors={title:"",url:"",response:"",delivery:"",trigger:""},this.hasSubmissionErrors={title:!1,url:!1,response:!1,delivery:!1,trigger:!1}},submitWebhook:function(){this.submitting=!0,this.errorMessage="",this.resetErrors();const e=this.buildWebhook();(new N).post(e).catch(this.processErrors).then(this.processSuccess)},buildWebhook:function(){return{title:this.title,url:this.url,response:this.response,delivery:this.delivery,trigger:this.trigger,active:!0}},dismissBanner:function(){this.errorMessage=""},processSuccess:function(e){if(!e)return;this.submitting=!1;let s={level:"success",text:"I am new webhook",show:!0,action:{show:!0,text:"Go to webhook",link:{name:"webhooks.show",params:{id:parseInt(e.data.data.id)}}}};this.$q.localStorage.set("flash",s),this.doReturnHere&&window.dispatchEvent(new CustomEvent("flash",{detail:{flash:this.$q.localStorage.getItem("flash")}})),this.doReturnHere||this.$router.go(-1)},processErrors:function(e){if(e.response){let s=e.response.data;this.errorMessage=s.message,console.log(s);for(let e in s.errors)s.errors.hasOwnProperty(e)&&(this.submissionErrors[e]=s.errors[e][0],this.hasSubmissionErrors[e]=!0)}this.submitting=!1}}};var C=r(1639),y=r(9885),O=r(7128),A=r(8879),U=r(4458),G=r(3190),Z=r(6611),Q=r(7887),P=r(1221),D=r(9984),H=r.n(D);const M=(0,C.Z)(W,[["render",V]]),F=M;H()(W,"components",{QPage:y.Z,QBanner:O.Z,QBtn:A.Z,QCard:U.Z,QCardSection:G.Z,QInput:Z.Z,QSelect:Q.Z,QCheckbox:P.Z})}}]);